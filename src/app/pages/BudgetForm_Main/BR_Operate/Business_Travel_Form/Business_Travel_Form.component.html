<section class="card card-content">
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-md-12 text-left">
            <span style="font-size:14pt;font-weight:bold">
                {{Form_Name}}
            </span>
        </div>
    </div>
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-md-12 text-left">
            <button type="button" class="btn btn-soft-primary waves-effect waves-light" (click)="add_new_Form()">
                เพิ่มโครงการ
            </button>
        </div>
    </div>
    <div>
        @for(Form_data of List_All; track $index){
            <div style="height:15px"></div>
            <div class="row">
                <div class="col-md-2 text-right">
                    โครงการ
                </div>
                <div class="col-md-2 text-right">
                    <input type="text" title="โครงการ" class="form-control" [(ngModel)]="Form_data.Project_Name" />
                </div>
                <div class="col-md-1 text-left">
                    <button type="button" class="btn btn-soft-primary waves-effect waves-light"
                (click)="add_form_detail(Form_data)">เพิ่มข้อมูล
            </button>
                </div>
                <div class="col-md-6 text-right">
                    <button class="btn btn-soft-danger waves-effect waves-light" style="width:120px" (click)="del_Form($index)">ลบโครงการ</button>
                </div>
            </div>
        <div style="height:15px"></div>
        <div class="row">
            <div class="col-lg-12">
                <div class="table">
                    <table class="table table-gridjs">
                        <thead>
                            <tr class="tr-center">
                                <th style="width: 5%;">ลำดับ</th>
                                <th style="width: 15%;">
                                    ตำแหน่ง
                                </th>
                                <th>
                                    ระดับ
                                </th>
                                <th style="width: 20%;">
                                    รายการ
                                </th>
                                <th>
                                    ครั้ง/รุ่น
                                </th>
                                <th>
                                    จำนวนคน
                                </th>
                                <th>
                                    จำนวนวัน/คืน/เที่ยว
                                </th>
                                <th>
                                    อัตราค่าใช้จ่าย
                                </th>
                                <th>
                                    รวมทั้งสิ้น
                                </th>
                                <th style="width: 5%;">ลบ</th>
                            </tr>
                        </thead>
                        <tbody>
                           @for(data of Form_data.List_Budget_Request_Detail_Item; track $index){
                            <tr class="tr-center">
                                <td style="text-align: center;">
                                    {{ $index + 1 }}
                                </td>
                                <td>
                                    <ng-select [items]="List_Mas_Position" bindLabel="Position_Name"
                                        bindValue="Position_Id" [(ngModel)]="data.Position_Id"
                                        [placeholder]="'กรุณาเลือก'" (change)="choose_ddl_position(data)">
                                        <ng-template ng-option-tmp let-s1="item">
                                            {{ s1.Position_Name}}
                                        </ng-template>
                                    </ng-select>
                                </td>
                                <td>
                                    <ng-select [items]="List_Mas_Business_Level" bindLabel="Level_Name"
                                        bindValue="Level_Id" [(ngModel)]="data.Level_Id" [placeholder]="'กรุณาเลือก'"
                                        (change)="choose_ddl_Business_Level(data)">
                                        <ng-template ng-option-tmp let-s1="item">
                                            {{ s1.Level_Name}}
                                        </ng-template>
                                    </ng-select>

                                </td>
                                <td>
                                    <ng-select [items]="List_Mas_Expense_Cost_Rate" bindLabel="Cost_Name"
                                        bindValue="Cost_Id" [(ngModel)]="data.Fk_Cost_Id" [placeholder]="'กรุณาเลือก'"
                                        (change)="choose_ddl_cost_rate(data)">
                                        <ng-template ng-option-tmp let-s2="item">
                                            {{ s2.Cost_Name}}
                                        </ng-template>
                                    </ng-select>
                                </td>
                                <td>
                                    <input class="form-control" type="number" title="ครั้ง/รุ่น"
                                        [(ngModel)]="data.Quantity" onkeypress="return isNumber(event);"
                                        (keyup)="cal_qty_item(data,Form_data)" />
                                </td>

                                <td>
                                    <input class="form-control" type="number" title="จำนวนคน" [(ngModel)]="data.People"
                                        onkeypress="return isNumber(event);" (keyup)="cal_qty_item(data,Form_data)" />
                                </td>
                                <td>
                                    <input class="form-control" type="number" title="จำนวนวัน/คืน/เที่ยว"
                                        [(ngModel)]="data.Qty_Day" onkeypress="return isNumber(event);"
                                        (keyup)="cal_qty_item(data,Form_data)" />
                                </td>
                                <td>
                                    <input class="form-control" type="number" title="อัตราค่าใช้จ่าย"
                                        [(ngModel)]="data.Cost_Amount" disabled (change)="cal_qty_item(data,Form_data)" />
                                </td>
                                <td>
                                    <input class="form-control" type="number"
                                        title="รวมทั้งสิ้น ครั้ง/รุ่น x จำนวนคน x จำนวนวัน/คืน/เที่ยว x อัตราค่าใช้จ่าย"
                                        disabled [(ngModel)]="data.Total" />
                                </td>
                                <td>
                                    <button type="button" class="btn btn-ghost-danger waves-effect waves-light"
                                        (click)="btn_del_Detail_item($index)">
                                        <i class="ri-delete-bin-6-fill" style="color: orangered;font-size: 20px;"></i>
                                    </button>
                                </td>
                            </tr>
                            }
                        </tbody>
                        <tfoot>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td style="text-align:right">รวม :</td>
                            <td style="text-align:center">
                                <!-- {{calculatedTotal }}
                                {{calculatedTotal_Front}} -->
                                {{ calculateTotalForForm(Form_data) | number:'1.2-2' }}
                            </td>
                            <td></td>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
        }
        
    </div>


</section>