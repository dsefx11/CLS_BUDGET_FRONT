<section>
    <div class="row">
        <div class="col-lg-12 text-left">
            <div class="card-header align-items-center d-flex">
                <h4 class="mb-0 flex-grow-1">คำขอโครงการ</h4>
            </div><!-- end card header -->
        </div>
    </div>
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-lg-6 text-left">
            <span style="font-size:10pt;font-weight:bold" class="badge badge-gradient-secondary">ส่วนที่ 1
                ข้อมูลทั่วไป</span>
        </div>

    </div>
    <div class="row">
        <div class="col-4">
            <h5>วงเงินงบประมาณ: <span style="color:red"> บาท</span></h5>
        </div>
    </div>
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-lg-1 text-right">
            <label> ชื่อโครงการ :</label>
        </div>
        <div class="col-lg-4 text-left">
            <span style="color:orangered;font-weight:bold">
                {{this.Budget_Request_Income.Topic_Income_Sub_Name}}
            </span>
        </div>
        <div class="col-lg-1 text-right">
            สอดรับโครงการ :
        </div>
        <div class="col-lg-4 text-left">
            <ng-select [items]="List_Mas_Project" bindLabel="Project_Name" bindValue="Project_Id"
                [(ngModel)]="Budget_Request_Income.Project_Support_Id" (change)="Choose_Mas_A()"
                [placeholder]="'กรุณาเลือก'">
                <ng-template ng-option-tmp let-h1="item">
                    {{ h1.Project_Name}}
                </ng-template>
            </ng-select>
            <!-- <ng-select [items]="List_Mas_National_Strategy" bindLabel="Strategy_Name"
                                                            bindValue="Strategy_Id" [(ngModel)]="Budget_Request_Income.Project_Support_Id"
                                                             [placeholder]="'กรุณาเลือก'">
                                                            <ng-template ng-option-tmp let-tab2D1="item">
                                                                {{ tab2D1.Strategy_Name}}
                                                            </ng-template>
                                                        </ng-select>  -->
        </div>
    </div>
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-lg-1 text-right">
            ลักษณะโครงการ :
        </div>
        <div class="col-lg-4 text-left">
            <label>โครงการที่ใช้งบประมาณ</label>
        </div>
        <div class="col-lg-1 text-right">
            ดำเนินการเอง :
        </div>
        <div class="col-lg-1 text-left">
            <input type="number" class="form-control" placeholder="% ที่ดำเนินการเอง"
                [(ngModel)]="Budget_Request_Income.Proceed_Qty"
                (ngModelChange)="Cal_Proceed_Qty(Budget_Request_Income.Proceed_Qty)" />
        </div>
        <div class="col-lg-1 text-right">
            จัดจ้าง :
        </div>
        <div class="col-lg-1 text-left">
            <input type="number" class="form-control" placeholder="% ที่จัดจ้าง"
                [(ngModel)]="Budget_Request_Income.Po_Qty" (ngModelChange)="Cal_Po_Qty(Budget_Request_Income.Po_Qty)" />
        </div>
    </div>
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-lg-1 text-right">
            ประเภทโครงการ :
        </div>
        <div class="col-lg-4 text-left">
            <!-- <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" [(ngModel)]="Budget_Request_Income.Project_Type_Id" value="1" (ngModelChange)="Choose_Project_Type_Id(Budget_Request_Income.Project_Type_Id)">
                <label class="form-check-label">ใหม่</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" [(ngModel)]="Budget_Request_Income.Project_Type_Id" value="2" (ngModelChange)="Choose_Project_Type_Id(Budget_Request_Income.Project_Type_Id)">
                <label class="form-check-label">ต่อเนื่อง</label>
            </div> -->
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" [checked]="Budget_Request_Income.Project_Type_Id == 1"
                    (change)="Choose_Project_Type_Id(Budget_Request_Income.Project_Type_Id, 1)" />
                <label class="form-check-label">ใหม่</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" [checked]="Budget_Request_Income.Project_Type_Id == 2"
                    (change)="Choose_Project_Type_Id(Budget_Request_Income.Project_Type_Id, 2)" />
                <label class="form-check-label">ต่อเนื่อง</label>
            </div>


        </div>
        <div class="col-lg-1 text-right">
            สถานะโครงการ :
        </div>
        <div class="col-lg-4 text-left">
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" [checked]="Budget_Request_Income.Project_Status_Id == 1"
                    (change)="Choose_Project_Status_Id(Budget_Request_Income.Project_Status_Id, 1)" />
                <label class="form-check-label">อยู่ระหว่างดำเนินการ</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" [checked]="Budget_Request_Income.Project_Status_Id == 2"
                    (change)="Choose_Project_Status_Id(Budget_Request_Income.Project_Status_Id, 2)" />
                <label class="form-check-label">ยังไม่ดำเนินการ</label>
            </div>
        </div>
    </div>
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-lg-1 text-right">
            จำนวนปีที่ดำเนินโครงการ : <span style="color:red;font-size:small">*สามารถกำหนดเดือนได้ไม่เกิน 5 ปี</span>
        </div>
        <div class="col-lg-1 text-left">
            <input type="number" class="form-control" placeholder="จำนวนปีที่ดำเนินโครงการ"
                [(ngModel)]="Budget_Request_Income.Project_Year_Count" onkeypress="return isNumber(event);"
                (keyup)="select_year_count('New')" />
        </div>
        <div class="col-lg-1 text-right" *ngIf="Budget_Request_Income.Project_Type_Id == 2">
            ปีนี้เป็นปีที่ :
        </div>
        <div class="col-lg-1 text-left" *ngIf="Budget_Request_Income.Project_Type_Id == 2">
            <input type="text" class="form-control" placeholder="ปีนี้เป็นปีที่"
                [(ngModel)]="Budget_Request_Income.Project_Year_Number" />
        </div>

    </div>
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-lg-1">
            ปีที่เริ่มต้น
            <input type="text" class="form-control" placeholder="ปีที่เริ่มต้น"
                [(ngModel)]="Budget_Request_Income.Project_Year_Start" disabled>
        </div>
        <div class="col-lg-1">
            ปีที่สิ้นสุด
            <input type="text" class="form-control" placeholder="ปีที่สิ้นสุด"
                [(ngModel)]="Budget_Request_Income.Project_Year_End" disabled>
        </div>

    </div>
    <div class="row">
        <div class="col-lg-12">
            <hr />
        </div>
    </div>
    <div style="height:15px"></div>
    <div class="row">
        <div class="col-lg-12">
            <!-- Nav tabs -->
            <ul ngbNav #Border="ngbNav" [activeId]="1" class="nav nav-tabs nav-border-top nav-border-top-primary mb-3">
                <li [ngbNavItem]="1">
                    <a ngbNavLink>
                        ส่วนที่ 2
                    </a>
                    <ng-template ngbNavContent>
                        <div class="d-flex">
                            <div class="flex-grow-1 ms-2">
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h4 style="font-weight:bold;text-decoration: underline;color: orangered;">
                                            ความเชื่อมโยงกับแผนในระดับต่างๆ</h4>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h4 style="font-weight:bold;text-decoration: underline;color: orangered;">
                                            แผนระดับที่ 1</h4>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h5><span style="font-weight:bold;color: orangered;">* </span><span
                                                style="font-weight:bold;">1.1 ยุทธศาสตร์ชาติที่เกี่ยวข้องโดยตรง
                                                (Z)</span></h5>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table">
                                            <table class="table table-gridjs"
                                                style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                <tbody>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ยุทธศาสตร์ชาติด้าน
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_National_Strategy"
                                                                bindLabel="Strategy_Name" bindValue="Strategy_Id"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Strategy_Id"
                                                                (ngModelChange)="Choose_Mas_National_Strategy_Detail()"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D1="item">
                                                                    {{ tab2D1.Strategy_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ประเด็น
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Strategy_Head_Issue"
                                                                bindLabel="Issues_Name" bindValue="Issues_Id"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Issues_Id"
                                                                (ngModelChange)="Choose_Mas_Strategy_Head_Issue_Detail()"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D2="item">
                                                                    {{ tab2D2.Issues_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ประเด็นย่อย
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Strategy_Sub_Issue"
                                                                bindLabel="Sub_Issues_Name" bindValue="Sub_Issues_Id"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Sub_Issues_Id"
                                                                (ngModelChange)="Choose_Mas_Strategy_Sub_Issue_Detail()"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D3="item">
                                                                    {{ tab2D3.Sub_Issues_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมาย
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <textarea class="form-control" rows="2"
                                                                style="font-size: 12px; height: 80px;"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Target_Name"></textarea>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h5><span style="font-weight:bold;color: orangered;">* </span><span
                                                style="font-weight:bold;">1.2 ยุทธศาสตร์ชาติที่เกี่ยวข้องในระดับรอง
                                                (Z)</span></h5>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12 text-left">
                                        <button type="button" class="btn btn-soft-primary waves-effect waves-light"
                                            (click)="add_form_Strategy_Sub_Item_detail()">เพิ่มรายการ</button>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table">
                                            <table class="table table-gridjs"
                                                style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                <tbody
                                                    *ngFor="let item_Strategy_Sub of List_Budget_Request_Income_Strategy_Sub_Item; let i = index">
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            <span
                                                                style="font-weight:bold;color: orangered;font-size: 16px;">{{i
                                                                + 1}} </span>ยุทธศาสตร์ชาติด้าน
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select [items]="List_Sec_Mas_National_Strategy"
                                                                bindLabel="Strategy_Name" bindValue="Strategy_Id"
                                                                [(ngModel)]="item_Strategy_Sub.Strategy_Id"
                                                                (ngModelChange)="Choose_Sub_Mas_National_Strategy_Detail(item_Strategy_Sub)"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D4="item">
                                                                    {{ tab2D4.Strategy_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                        <th style="width: 1%; padding: 6px 8px;" rowspan="5">
                                                            <button type="button"
                                                                class="btn btn-ghost-danger waves-effect waves-light"
                                                                style="padding: 2px 6px;"
                                                                (click)="btn_del_Strategy_Sub_Item_Detail_item(i)">
                                                                <i class="ri-delete-bin-6-fill"
                                                                    style="color: orangered;font-size: 16px;"></i>
                                                            </button>
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ประเด็น
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select
                                                                [items]="item_Strategy_Sub.List_Sec_Sub_Mas_Strategy_Head_Issue"
                                                                bindLabel="Issues_Name" bindValue="Issues_Id"
                                                                [(ngModel)]="item_Strategy_Sub.Issues_Id"
                                                                (ngModelChange)="Choose_Sub_Mas_Strategy_Head_Issue_Detail(item_Strategy_Sub)"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D5="item">
                                                                    {{ tab2D5.Issues_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ประเด็นย่อย
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select
                                                                [items]="item_Strategy_Sub.List_Sec_Strategy_Sub_Issue"
                                                                bindLabel="Sub_Issues_Name" bindValue="Sub_Issues_Id"
                                                                [(ngModel)]="item_Strategy_Sub.Sub_Issues_Id"
                                                                (ngModelChange)="Choose_Sub_Mas_Strategy_Sub_Issue_Detail(item_Strategy_Sub)"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D6="item">
                                                                    {{ tab2D6.Sub_Issues_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมาย
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <textarea class="form-control"
                                                                [(ngModel)]="item_Strategy_Sub.Target_Name" rows="2"
                                                                style="font-size: 12px; height: 80px;"></textarea>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ความสอดคล้องของโครงการกับยุทธศาสตร์ชาติ (โปรดอธิบาย)
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <textarea class="form-control"
                                                                [(ngModel)]="item_Strategy_Sub.Consistency_Name"
                                                                rows="2"
                                                                style="font-size: 12px; height: 80px;"></textarea>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h4 style="font-weight:bold;text-decoration: underline;color: orangered;">
                                            แผนระดับที่ 2</h4>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h5><span style="font-weight:bold;color: orangered;">* </span><span
                                                style="font-weight:bold;">2.1
                                                ความสอดคล้องกับแผนแม่บทภายใต้ยุทธศาสตร์ชาติ (Y)</span></h5>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12 text-left">
                                        <button type="button" class="btn btn-soft-primary waves-effect waves-light"
                                            (click)="add_form_Consistency_MS_Plan_Item_detail()">เพิ่มรายการ</button>
                                    </div>
                                </div>

                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table">
                                            <table class="table table-gridjs"
                                                style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                <tbody
                                                    *ngFor="let item_Consistency_MS_Plan of List_Budget_Request_Income_Consistency_MS_Plan_Item; let i = index">
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            <span
                                                                style="font-weight:bold;color: orangered;font-size: 16px;">{{i
                                                                + 1}} </span>ประเด็น
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <ng-select
                                                                [items]="List_Mas_MasterPlan_Under_Nationnal_Strategy"
                                                                bindLabel="MasterPlan_Name" bindValue="MasterPlan_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.MasterPlan_Id"
                                                                (ngModelChange)="Choose_Mas_MasterPlan_Under_Nationnal_Strategy_Detail(item_Consistency_MS_Plan)"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D7="item">
                                                                    {{ tab2D7.MasterPlan_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                        <th style="width: 1%; padding: 6px 8px;" rowspan="13">
                                                            <button type="button"
                                                                class="btn btn-ghost-danger waves-effect waves-light"
                                                                style="padding: 2px 6px;"
                                                                (click)="btn_del_Consistency_MS_Plan_Item(i)">
                                                                <i class="ri-delete-bin-6-fill"
                                                                    style="color: orangered;font-size: 16px;"></i>
                                                            </button>
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมายระดับประเด็น (Y2)
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <ng-select
                                                                [items]="item_Consistency_MS_Plan.List_Mas_MasterPlan_Target"
                                                                bindLabel="Target_Name" bindValue="Target_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Target_Id"
                                                                (ngModelChange)="Choose_Mas_MasterPlan_Target_Detail(item_Consistency_MS_Plan)"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D8="item">
                                                                    {{ tab2D8.Target_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ความสอดคล้องของโครงการกับเป้าหมายของแผนแม่บท (โปรดอธิบาย)
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <textarea class="form-control" rows="2"
                                                                style="font-size: 12px; height: 80px;"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Consistency_Master_Plan_Name"></textarea>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            แผนย่อยของแผนแม่บทฯ
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <ng-select
                                                                [items]="item_Consistency_MS_Plan.List_Mas_Sub_MasterPlan"
                                                                bindLabel="Sub_MasterPlan_Name"
                                                                bindValue="Sub_MasterPlan_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Sub_MasterPlan_Id"
                                                                (ngModelChange)="Choose_Mas_Sub_MasterPlan_Detail(item_Consistency_MS_Plan)"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D9="item">
                                                                    {{ tab2D9.Sub_MasterPlan_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมายแผนแม่บทย่อย (Y1)
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <ng-select
                                                                [items]="item_Consistency_MS_Plan.List_Mas_Sub_MasterPlan_Target"
                                                                bindLabel="Sub_Target_Name" bindValue="Sub_Target_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Sub_Target_Id"
                                                                (ngModelChange)="Choose_Mas_Sub_MasterPlan_Target_Detail(item_Consistency_MS_Plan)"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D10="item">
                                                                    {{ tab2D10.Sub_Target_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ความสอดคล้องของโครงการกับเป้าหมายของแผนย่อย (โปรดอธิบาย)
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <textarea class="form-control" rows="2"
                                                                style="font-size: 12px; height: 80px;"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Consistency_Sub_Master_Plan_Name"></textarea>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            แนวทางการพัฒนาภายใต้แผนย่อย
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <ng-select
                                                                [items]="item_Consistency_MS_Plan.List_Mas_Sub_MasterPlan_Develop"
                                                                bindLabel="Sub_Develop_Name" bindValue="Sub_Develop_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Sub_Develop_Id"
                                                                (ngModelChange)="Choose_Mas_Sub_MasterPlan_Develop_Detail(item_Consistency_MS_Plan)"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D11="item">
                                                                    {{ tab2D11.Sub_Develop_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;background-color: papayawhip;"
                                                            class="text-left" colspan="3">
                                                            สอดคล้องห่วงโซ่คุณค่า (Value Chains) ของเป้าหมายแผนย่อย
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            หลัก
                                                        </th>
                                                        <td style="width: 45%;padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Project"
                                                                bindLabel="Project_Name" bindValue="Project_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Value_Chains_Id"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D12="item">
                                                                    {{ tab2D12.Project_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                        <td style="width: 45%;padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Project"
                                                                bindLabel="Project_Name" bindValue="Project_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Value_Chains_Sub_Id"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D13="item">
                                                                    {{ tab2D13.Project_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ส่วนสนับสนุน (ถ้ามี)
                                                        </th>
                                                        <td style="width: 45%;padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Project"
                                                                bindLabel="Project_Name" bindValue="Project_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Value_Chains_Support_Id"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D14="item">
                                                                    {{ tab2D14.Project_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                        <td style="width: 45%;padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Project"
                                                                bindLabel="Project_Name" bindValue="Project_Id"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Value_Chains_Sub_Support_Id"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D15="item">
                                                                    {{ tab2D15.Project_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;background-color: papayawhip;"
                                                            class="text-left" colspan="3">
                                                            สอดคล้องกับเป้าหมาย SDGs
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมายหลัก SDGs (Gloals)
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <textarea class="form-control" rows="2"
                                                                style="font-size: 12px; height: 80px;"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Target_SDGs_Gloals_Name"></textarea>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมายย่อย SDGs (Targets)
                                                        </th>
                                                        <td style="padding: 6px 8px;" colspan="2">
                                                            <textarea class="form-control" rows="2"
                                                                style="font-size: 12px; height: 80px;"
                                                                [(ngModel)]="item_Consistency_MS_Plan.Target_SDGs_Gloals_Targets_Name"></textarea>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>


                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h5><span style="font-weight:bold;">2.2
                                                แผนปฏิรูปประเทศด้านที่เกี่ยวข้องโดยตรง</span></h5>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table">
                                            <table class="table table-gridjs"
                                                style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                <tbody>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            แผนปฏิรูปด้าน
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Project"
                                                                bindLabel="Project_Name" bindValue="Project_Id"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Plan_Reform_Id"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D16="item">
                                                                    {{ tab2D16.Project_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมาย
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input type="text" class="form-control" title="เป้าหมาย"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Target_Reform_Name" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ประเด็นปฏิรูป
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input type="text" class="form-control"
                                                                title="ประเด็นปฏิรูป"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Issues_Reform_Name" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            กิจกรรม/กิจกรรมย่อย
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input class="form-control" type="text"
                                                                title="กิจกรรม/กิจกรรมย่อย"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Activity_Reform" />
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h5><span style="font-weight:bold;">2.3
                                                แผนปฏิรูปประเทศด้านที่เกี่ยวข้องในระดับรอง</span></h5>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table">
                                            <table class="table table-gridjs"
                                                style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                <tbody>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            แผนปฏิรูปด้าน
                                                        </th>
                                                        <!-- ยังไม่มี ข้อมูล Mas -->
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Project"
                                                                bindLabel="Project_Name" bindValue="Project_Id"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Sub_Plan_Reform_Id"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D17="item">
                                                                    {{ tab2D17.Project_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมาย
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input type="text" class="form-control" title="เป้าหมาย"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Sub_Target_Name" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ประเด็นปฏิรูป
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input type="text" class="form-control"
                                                                title="ประเด็นปฏิรูป"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Sub_Issues_Reform_Name" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            กิจกรรม/กิจกรรมย่อย
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input class="form-control" type="text"
                                                                title="กิจกรรม/กิจกรรมย่อย"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Sub_Activity_Reform" />
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h5><span style="color:red;">*</span> <span style="font-weight:bold;">2.4
                                                ความสอดคล้องกับร่างแผนพัฒนาเศรษฐกิจและสังคมแห่งชาติ (ฉบับที่ 13)</span>
                                        </h5>
                                    </div>
                                </div>


                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table">
                                            <table class="table table-gridjs"
                                                style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                <tbody>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            หมุดหมายที่
                                                        </th>
                                                        <!-- ยังไม่มี ข้อมูล Mas -->
                                                        <td style="padding: 6px 8px;">
                                                            <ng-select [items]="List_Mas_Project"
                                                                bindLabel="Project_Name" bindValue="Project_Id"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Destination_Id"
                                                                [placeholder]="'กรุณาเลือก'">
                                                                <ng-template ng-option-tmp let-tab2D18="item">
                                                                    {{ tab2D18.Project_Name}}
                                                                </ng-template>
                                                            </ng-select>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            เป้าหมายที่
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input type="text" class="form-control" title="เป้าหมาย"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Target_Consistent_Plan_Nation_Name" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ตัวชี้วัดที่
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <textarea class="form-control" rows="2"
                                                                style="font-size: 12px; height: 80px;"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Indicators_Name"></textarea>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            กลยุทธ์การพัฒนาที่
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input class="form-control" type="text"
                                                                title="กิจกรรม/กิจกรรมย่อย"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Development_Strategy_Name" />
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            กลยุทธ์ย่อยที่
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input class="form-control" type="text"
                                                                title="กิจกรรม/กิจกรรมย่อย"
                                                                [(ngModel)]="Budget_Request_Income_Detail.Sub_Development_Strategy_Name" />
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h5><span style="font-weight:bold;">2.5
                                                ความสอดคล้องกับแผนความมั่นคงชาติ</span></h5>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12 text-left">
                                        <button type="button" class="btn btn-soft-primary waves-effect waves-light"
                                            (click)="add_form_Consistent_Plan_Nation_Item_detail()">เพิ่มรายการ</button>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table">
                                            <table class="table table-gridjs"
                                                style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                <tbody
                                                    *ngFor="let item_Consistent_Plan_Nation of List_Budget_Request_Income_Consistent_Plan_Nation_Item; let i = index">
                                                    <tr>
                                                        <th style="width: 10%;" class="text-right">
                                                            ประเด็นที่สอดคล้อง<span
                                                                style="font-weight:bold;color: orangered;font-size: 16px;">
                                                                {{i + 1}}</span>
                                                        </th>
                                                        <td style="padding: 6px 8px;">
                                                            <input class="form-control" type="text"
                                                                title="ประเด็นที่สอดคล้อง (1)"
                                                                [(ngModel)]="item_Consistent_Plan_Nation.Consistent_Issues_Name" />
                                                        </td>
                                                        <th style="width: 1%; padding: 6px 8px;">
                                                            <button type="button"
                                                                class="btn btn-ghost-danger waves-effect waves-light"
                                                                style="padding: 2px 6px;"
                                                                (click)="btn_del_Consistent_Plan_Nation_Item(i)">
                                                                <i class="ri-delete-bin-6-fill"
                                                                    style="color: orangered;font-size: 16px;"></i>
                                                            </button>
                                                        </th>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <h4 style="font-weight:bold;text-decoration: underline;color: orangered;">
                                            แผนระดับที่ 3</h4>
                                    </div>
                                </div>
                                <!-- แผนระดับ3->วนความสอดคล้อง -->
                                <div *ngFor="let item_p3 of List_Mas_Project_Consistency; let i = index">
                                    <!-- 3.1 -->
                                    <ng-container *ngIf="item_p3.Sort_Index == 1; else checkSortIndex4">
                                        <div style="height:15px"></div>
                                        <div class="row">
                                            <div class="col-lg-6 text-left">
                                                <h5><span style="font-weight:bold;">3.1 ตามมติ ครม. วันที่ 4 ธันวาคม
                                                        2560</span></h5>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-12 text-left">
                                                <button type="button"
                                                    class="btn btn-soft-primary waves-effect waves-light"
                                                    (click)="add_form_Consistent_Plan_Item_detail()">เพิ่มรายการ</button>
                                            </div>
                                        </div>
                                        <div style="height:5px"></div>
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="table">
                                                    <table class="table table-gridjs"
                                                        style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                        <tbody
                                                            *ngFor="let item_Consistent_Plan of List_Budget_Request_Income_Consistent_Plan_Item; let i = index">
                                                            <tr>
                                                                <th style="width: 10%;" class="text-right">
                                                                    แผนที่สอดคล้อง<span
                                                                        style="font-weight:bold;color: orangered;font-size: 16px;">
                                                                        {{i + 1}}</span>
                                                                </th>
                                                                <td style="padding: 6px 8px;">
                                                                    <input class="form-control" type="text"
                                                                        title="แผนที่สอดคล้อง (1)"
                                                                        [(ngModel)]="item_Consistent_Plan.Consistent_Plane_Name" />
                                                                </td>
                                                                <th style="width: 1%; padding: 6px 8px;">
                                                                    <button type="button"
                                                                        class="btn btn-ghost-danger waves-effect waves-light"
                                                                        style="padding: 2px 6px;"
                                                                        (click)="btn_del_Consistent_Plan_Item(i)">
                                                                        <i class="ri-delete-bin-6-fill"
                                                                            style="color: orangered;font-size: 16px;"></i>
                                                                    </button>
                                                                </th>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-container>
                                    <!-- 3.4 -->
                                    <ng-template #checkSortIndex4>
                                        <ng-container *ngIf="item_p3.Sort_Index == 4; else checkSortIndex5">
                                            <div style="height:15px"></div>
                                            <div class="row">
                                                <div class="col-lg-6 text-left">
                                                    <h5><span style="font-weight:bold">3.4 กฏหมายที่เกี่ยวข้อง</span>
                                                    </h5>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12 text-left">
                                                    <button type="button"
                                                        class="btn btn-soft-primary waves-effect waves-light"
                                                        (click)="add_form_Law_Relate_Item_detail()">เพิ่มรายการ</button>
                                                </div>
                                            </div>
                                            <div style="height:5px"></div>
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="table">
                                                        <table class="table table-gridjs"
                                                            style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                            <tbody
                                                                *ngFor="let item_Law_Relate of List_Budget_Request_Income_Law_Relate_Item; let i = index">
                                                                <tr>
                                                                    <th style="width: 3%;" class="text-right">
                                                                        <span
                                                                            style="font-weight:bold;color: orangered;font-size: 16px;">
                                                                            {{i + 1}}</span>
                                                                    </th>
                                                                    <!-- ยังไม่มี Mas ข้อมูล -->
                                                                    <td style="padding: 6px 8px;">
                                                                        <ng-select [items]="List_Mas_Project"
                                                                            bindLabel="Project_Name"
                                                                            bindValue="Project_Id"
                                                                            [(ngModel)]="item_Law_Relate.Law_Relate_Id"
                                                                            [placeholder]="'กรุณาเลือก'">
                                                                            <ng-template ng-option-tmp
                                                                                let-tab2D19="item">
                                                                                {{ tab2D19.Project_Name}}
                                                                            </ng-template>
                                                                        </ng-select>
                                                                        <!-- (change)="Law_Relate_Name" -->
                                                                    </td>
                                                                    <th style="width: 1%; padding: 6px 8px;">
                                                                        <button type="button"
                                                                            class="btn btn-ghost-danger waves-effect waves-light"
                                                                            style="padding: 2px 6px;"
                                                                            (click)="btn_del_Law_Relate_Item(i)">
                                                                            <i class="ri-delete-bin-6-fill"
                                                                                style="color: orangered;font-size: 16px;"></i>
                                                                        </button>
                                                                    </th>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-container>

                                    </ng-template>
                                    <!-- 3.5 -->
                                    <ng-template #checkSortIndex5>
                                        <ng-container
                                            *ngIf="item_p3.Sort_Index == 5; else showList_Project_Consistency">
                                            <div style="height:15px"></div>
                                            <div class="row">
                                                <div class="col-lg-6 text-left">
                                                    <h5><span style="font-weight:bold">3.5
                                                            มติคณะรัฐมนตรีที่เกี่ยวข้อง</span> </h5>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12 text-left">
                                                    <button type="button"
                                                        class="btn btn-soft-primary waves-effect waves-light"
                                                        (click)="add_form_Cabinet_Resolution_Item_detail()">เพิ่มรายการ</button>
                                                </div>
                                            </div>
                                            <div style="height:5px"></div>
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="table">
                                                        <table class="table table-gridjs"
                                                            style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                            <tbody
                                                                *ngFor="let item_Cabinet_Resolution of List_Budget_Request_Income_Cabinet_Resolution_Item; let i = index">
                                                                <tr>
                                                                    <th style="width: 3%;" class="text-right">
                                                                        <span
                                                                            style="font-weight:bold;color: orangered;font-size: 16px;">
                                                                            {{i + 1}}</span>
                                                                    </th>
                                                                    <td style="padding: 6px 8px;">
                                                                        <!-- ยังไม่มี Mas ข้อมูล -->
                                                                        <ng-select [items]="List_Mas_Project"
                                                                            bindLabel="Project_Name"
                                                                            bindValue="Project_Id"
                                                                            [(ngModel)]="item_Cabinet_Resolution.Cabinet_Resolution_Id"
                                                                            [placeholder]="'กรุณาเลือก'">
                                                                            <ng-template ng-option-tmp
                                                                                let-tab2D20="item">
                                                                                {{ tab2D20.Project_Name}}
                                                                            </ng-template>
                                                                        </ng-select>
                                                                        <!-- (change)="Cabinet_Resolution_Name" -->
                                                                    </td>
                                                                    <th style="width: 1%; padding: 6px 8px;">
                                                                        <button type="button"
                                                                            class="btn btn-ghost-danger waves-effect waves-light"
                                                                            style="padding: 2px 6px;"
                                                                            (click)="btn_del_Cabinet_Resolution_Item(i)">
                                                                            <i class="ri-delete-bin-6-fill"
                                                                                style="color: orangered;font-size: 16px;"></i>
                                                                        </button>
                                                                    </th>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </ng-template>
                                    <!-- 3.2/3.3/3.6/3.7/3.8 -->
                                    <ng-template #showList_Project_Consistency>
                                        <div style="height:15px"></div>
                                        <div
                                            *ngFor="let item_p4_sub of getConsistencySubByType(item_p3.Consistency_Type_Id); let i = index">
                                            <!-- แสดงหัวข้อหลักเฉพาะครั้งแรกของแต่ละประเภท -->
                                            <div class="row" *ngIf="i === 0">
                                                <div style="height:15px"></div>
                                                <div class="row">
                                                    <div class="col-lg-12 text-left">
                                                        <h5><span
                                                                style="font-weight:bold;">{{item_p3.Consistency_Type_Name}}</span>
                                                        </h5>
                                                    </div>
                                                </div>
                                                <div style="height:15px"></div>
                                            </div>
                                            <!-- แสดงหัวข้อย่อยเฉพาะเมื่อเปลี่ยนหัวข้อ -->
                                            <div class="row"
                                                *ngIf="item_p4_sub.Consistency_Sec_Name && (i === 0 || item_p4_sub.Consistency_Sec_Name !== getConsistencySubByType(item_p3.Consistency_Type_Id)[i-1].Consistency_Sec_Name)">
                                                <div class="row">
                                                    <div class="col-lg-12 text-left">
                                                        <h5>
                                                            <span
                                                                style="font-weight:bold;padding-left: 40px;">{{item_p4_sub.Consistency_Sec_Name}}</span>
                                                        </h5>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row" style="padding-left: 60px;">
                                                <div class="col-lg-12 text-left">
                                                    <table class="table table-gridjs"
                                                        style="width:100%;font-size: 12px; margin: 0;">
                                                        <tbody>
                                                            <tr>
                                                                <td
                                                                    style="width: 1%;padding-right: 8px; vertical-align: middle; text-align: center;">
                                                                    <input class="form-check-input" type="checkbox"
                                                                        [(ngModel)]="item_p4_sub.Chk_Row_Consistency"
                                                                        (ngModelChange)="onConsistencyCheckboxChange(item_p3,item_p4_sub)">
                                                                </td>
                                                                <td
                                                                    style="width: 99%;vertical-align: middle; padding: 2; text-align: left;">
                                                                    <span>{{item_p4_sub.Consistency_Sub_Name}}</span>
                                                                    <ng-container
                                                                        *ngIf="item_p4_sub.Consistency_Name === '3.7'">
                                                                        <br>
                                                                        <span
                                                                            style="color:red">หมายเหตุ/คำอธิบายอื่นๆ</span>
                                                                        <input type="text" class="form-control"
                                                                            placeholder="ไม่บังคับ ระบุหมายเหตุหรือคำอธิบายอื่นๆ (ถ้ามี)"
                                                                            [(ngModel)]="item_p4_sub.Target_Remark"
                                                                            (ngModelChange)="onConsistencyCheckboxChange(item_p3,item_p4_sub)" />
                                                                    </ng-container>
                                                                    <ng-container
                                                                        *ngIf="item_p4_sub.Consistency_Name === '3.8'">
                                                                        <br>
                                                                        <div class="row">
                                                                            <div class="col-lg-6 text-left">
                                                                                <span
                                                                                    style="color:red">กลยุทธ์ข้อที่</span>
                                                                                <!-- ยังไม่มี Mas ข้อมูล -->
                                                                                <ng-select [items]="List_Mas_Project"
                                                                                    bindLabel="Project_Name"
                                                                                    bindValue="Project_Id"
                                                                                    [(ngModel)]="Budget_Request_Income.Topic_Income_Sub_Id"
                                                                                    [placeholder]="'กรุณาเลือก'">
                                                                                    <ng-template ng-option-tmp
                                                                                        let-tab2D21="item">
                                                                                        {{ tab2D21.Project_Name}}
                                                                                    </ng-template>
                                                                                </ng-select>
                                                                            </div>
                                                                            <div class="col-lg-6 text-left">
                                                                                <span
                                                                                    style="color:red">มาตรการที่</span>
                                                                                <ng-select [items]="List_Mas_Project"
                                                                                    bindLabel="Project_Name"
                                                                                    bindValue="Project_Id"
                                                                                    [(ngModel)]="Budget_Request_Income.Topic_Income_Sub_Id"
                                                                                    [placeholder]="'กรุณาเลือก'">
                                                                                    <ng-template ng-option-tmp
                                                                                        let-tab2D22="item">
                                                                                        {{ tab2D22.Project_Name}}
                                                                                    </ng-template>
                                                                                </ng-select>
                                                                            </div>
                                                                        </div>

                                                                    </ng-container>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </div>
                                <!-- End Body In Tap1 / ส่่วนที่ 2 -->
                            </div>
                        </div>
                    </ng-template>
                </li>
                <li [ngbNavItem]="2">
                    <a ngbNavLink>
                        ส่วนที่ 3
                    </a>
                    <ng-template ngbNavContent>
                        <div class="d-flex">
                            <div class="flex-grow-1 ms-2">
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <span
                                            style="font-size:14pt;font-weight:bold">รายละเอียดแผนงาน/โครงการ/การดำเนินการ
                                            (X)</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <span style="color:red">*</span><span>1.หลักการและเหตุผล</span><span
                                            style="color:red;font-size:small"> โปรดระบุค่านี้ก่อน</span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3" title="1.หลักการและเหตุผล"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.Principles_Reasons_Name"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <span style="color:red">*</span><span>2.วัตถุประสงค์</span><span
                                            style="color:red;font-size:small"> โปรดระบุค่านี้ก่อน</span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3" title="วัตถุประสงค์"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.Purpose_Name"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <span style="font-size:14pt;font-weight:bold">3 เป้าหมายการดำเนินโครงการ</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <span style="color:red">*</span><span>3.1 เป้าหมายเชิงผลผลิต
                                            (Output)</span><span style="color:red;font-size:small">
                                            โปรดระบุค่านี้ก่อน</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3" title="3.1 เป้าหมายเชิงผลผลิต"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.Target_Output"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <span style="color:red">*</span><span>3.2 เป้าหมายเชิงผลลัพธ์
                                            (Outcome)</span><span style="color:red;font-size:small">
                                            โปรดระบุค่านี้ก่อน</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3" title="3.2 เป้าหมายเชิงผลลัพธ์"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.Target_Outcome"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <span style="color:red">*</span><span>4.ผลที่คาดว่าจะเกิด</span><span
                                            style="color:red;font-size:small"> โปรดระบุค่านี้ก่อน</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3" title="4.ผลที่คาดว่าจะเกิด"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.Target_Results"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <hr style="color:red" />
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <span style="font-size:14pt;font-weight:bold">5. ตัวชี้วัดและค่าเป้าหมายโครงการ
                                            (KPI)</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <span style="color:red">*</span><span>ตัวชี้วัดผลผลิต (Output)</span><span
                                            style="color:red;font-size:small"> โปรดระบุค่านี้ก่อน</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3"
                                            title="5. ตัวชี้วัดและค่าเป้าหมายโครงการ"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.Indicators_Output"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <span style="color:red">*</span><span>5.2 ตัวชี้วัดผลลัพธ์ (Outcome)</span><span
                                            style="color:red;font-size:small"> โปรดระบุค่านี้ก่อน</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3" title="5.2 ตัวชี้วัดผลลัพธ์ (Outcome)"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.Indicators_Outcome"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <span style="font-size:14pt;font-weight:bold">6. ความสำเร็จของตัวชี้วัดรายไตรมาส
                                            (Small Success)</span>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12 text-left">
                                        <button type="button" class="btn btn-soft-primary waves-effect waves-light"
                                            (click)="add_form_Project_Detial_Item_detail()">เพิ่มรายการ</button>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table">
                                            <table class="table table-gridjs"
                                                style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                <thead>
                                                    <tr>
                                                        <th>ลำดับ</th>
                                                        <th>เป้าหมาย</th>
                                                        <th>ไตรมาส 1</th>
                                                        <th>ไตรมาส 2</th>
                                                        <th>ไตรมาส 3</th>
                                                        <th>ไตรมาส 4</th>
                                                        <th>ลบ</th>
                                                    </tr>
                                                </thead>
                                                <tbody
                                                    *ngFor="let item_Project_Detail of List_Budget_Request_Income_Project_Detial_Item; let i = index">
                                                    <tr>
                                                        <td style="width: 2%;" class="text-right">
                                                            {{i + 1}}
                                                        </td>
                                                        <td>
                                                            <textarea class="form-control" rows="3"
                                                                placeholder="เป้าหมาย"
                                                                [(ngModel)]="item_Project_Detail.SS_Target"
                                                                style="height:120px"></textarea>
                                                        </td>
                                                        <td>
                                                            <textarea class="form-control" rows="3"
                                                                placeholder="ไตรมาส 1"
                                                                [(ngModel)]="item_Project_Detail.SS_Q1"
                                                                style="height:120px"></textarea>
                                                        </td>
                                                        <td>
                                                            <textarea class="form-control" rows="3"
                                                                placeholder="ไตรมาส 2"
                                                                [(ngModel)]="item_Project_Detail.SS_Q2"
                                                                style="height:120px"></textarea>
                                                        </td>
                                                        <td>
                                                            <textarea class="form-control" rows="3"
                                                                placeholder="ไตรมาส 3"
                                                                [(ngModel)]="item_Project_Detail.SS_Q3"
                                                                style="height:120px"></textarea>
                                                        </td>
                                                        <td>
                                                            <textarea class="form-control" rows="3"
                                                                placeholder="ไตรมาส 4"
                                                                [(ngModel)]="item_Project_Detail.SS_Q4"
                                                                style="height:120px"></textarea>
                                                        </td>
                                                        <th style="width: 1%; padding: 6px 8px;">
                                                            <button type="button"
                                                                class="btn btn-ghost-danger waves-effect waves-light"
                                                                style="padding: 2px 6px;"
                                                                (click)="btn_del_Week_Item(i, item_Project_Detail.Request_Income_Multi_Id)">
                                                                <i class="ri-delete-bin-6-fill"
                                                                    style="color: orangered;font-size: 16px;"></i>
                                                            </button>
                                                        </th>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <span style="color:red">*</span><span>7.
                                            กลุ่มเป้าหมาย/ผู้ได้รับผลประโยชน์</span><span
                                            style="color:red;font-size:small"></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3"
                                            placeholder="กลุ่มเป้าหมาย หรือ ผู้ได้รับผลประโยชน์ จากการดำเนินโครงการนี้"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.SS_Target_Group"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div style="height:15px"></div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <span style="color:red">*</span><span>8. พื้นที่การดำเนินการ</span><span
                                            style="color:red;font-size:small"></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <textarea class="form-control" rows="3" placeholder="พื้นที่การดำเนินการ"
                                            [(ngModel)]="Budget_Request_Income_Project_Detial.SS_Area"
                                            style="height:120px"></textarea>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <hr style="color:red" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 text-left">
                                        <span style="color:red">*</span><span>9. ระยะเวลาในการดำเนินโครงการ</span><span
                                            style="color:red;font-size:small"></span>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <!-- <input type="text" class="datepicker" id="SelectDate" [(ngModel)]="SelectDate"
                                            data-provide="datepicker" data-date-language="th-th" autocomplete="off"
                                            placeholder="โปรดเลือกปฎิทิน ช่วงวันที่ในการดำเนินโครงการ (บังคับ)" />
                                        <label class="input-group-btn" for="SelectDate" style="width: 0%">
                                            <span class="bi bi-calendar3"></span>
                                        </label> -->
                                        <input class="form-control flatpickr-input" type="text"
                                            placeholder="โปรดเลือกปฎิทิน ช่วงวันที่ในการดำเนินโครงการ (บังคับ)"
                                            mwlFlatpickr [altInput]="true" [convertModelValue]="true" mode="range"
                                            altFormat="d/m/Y" dateFormat="d/m/Y" [options]="datePickerOptions"
                                            [(ngModel)]="dateRange" (ngModelChange)="onDateRangeChange(dateRange)"
                                            style="font-family: 'Sarabun', sans-serif;">
                                        <!-- <input
                                        mwlFlatpickr
                                        class="form-control"
                                        placeholder="เลือกช่วงวันที่ (พ.ศ.)"
                                        [option]="datePickerOptions"
                                        [(ngModel)]="dateRange"
                                        style="font-family: 'Sarabun', sans-serif;" /> -->
                                        <!-- <style>
                                            /* ซ่อนปี ค.ศ. ในปฏิทิน */
                                            .flatpickr-current-month .cur-year,
                                            .flatpickr-months .cur-year,
                                            .flatpickr-current-month span.cur-year,
                                            .flatpickr-months span.cur-year {
                                                display: none !important;
                                                visibility: hidden !important;
                                                opacity: 0 !important;
                                            }
                                            /* แสดงปี พ.ศ. แทน */
                                            .flatpickr-current-month::after {
                                                content: "2568";
                                                font-weight: bold;
                                                margin-left: 5px;
                                                color: #000;
                                            }
                                            /* ซ่อนปีในส่วนอื่นๆ ของปฏิทิน */
                                            .flatpickr-months .cur-year,
                                            .flatpickr-current-month .cur-year {
                                                display: none !important;
                                            }
                                        </style> -->
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <hr style="color:red" />
                                    </div>
                                </div>
                                <!-- End Body In Tap1 / ส่่วนที่ 3 -->
                            </div>
                        </div>
                    </ng-template>
                </li>
                <li [ngbNavItem]="3">
                    <a ngbNavLink>
                        ส่วนที่ 4
                    </a>
                    <ng-template ngbNavContent>
                        <div class="d-flex">
                            <div class="flex-grow-1 ms-2">
                                <div class="form-body">
                                    <div class="row">
                                        <div class="col-lg-3 text-left">
                                            <span style="color:red;font-size:small">วงเงินงบประมาณของโครงการต้องมากกว่า
                                                0
                                                บาท</span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                        <button type="button" class="btn btn-soft-primary waves-effect waves-light"
                                                (click)="pre_save_detial_input()">Pre_Save_Log</button>    
                                        </div>
                                    </div>




                                    <div style="height:15px"></div>
                                    <div class="row">
                                        <div class="col-lg-2 text-left">
                                            <span style="font-size:14pt;font-weight:bold">รายการกิจกรรม</span>
                                        </div>
                                    </div>
                                    <div style="height:15px"></div>
                                    <div class="row">
                                        <div class="col-lg-12 text-left">
                                            <button type="button" class="btn btn-soft-primary waves-effect waves-light"
                                                (click)="add_form_Income_Multi_Item_detail('Main')">เพิ่มรายการกิจกรรม</button>
                                        </div>
                                    </div>
                                    <div style="height:15px"></div>
                                    <div class="row">
                                        <div class="col-lg-12" style="overflow-x:auto; white-space:nowrap;">
                                            <div class="table-responsive" >
                                                <table class="table table-gridjs"
                                                style="min-width:110%; font-size:12px; margin:0 auto;">
                                                    <thead>
                                                        <!-- แถว 1: หัวหลัก + ปี (ปีละ 12 คอลัมน์: 4 ไตรมาส × 3 คอลัมน์ย่อย) -->
                                                        <tr class="text-center">
                                                            <th rowspan="3" style="width:1%;">ลำดับ</th>
                                                            <!-- ✅ ปรับความกว้างกิจกรรม -->
                                                            <th rowspan="3" style="width:10%;">กิจกรรม</th>
                                                            <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                              <th class="text-center" [attr.colspan]="4 * 3">ปี {{ y }}</th> <!-- 4ไตรมาส มีละไตรมาสมี 3 คอลัมน์ -->
                                                            </ng-container>
                                                            <th rowspan="3" style="width:1%;">ลบ</th>
                                                        </tr>
                                                      
                                                        <!-- แถว 2: หัวไตรมาส -->
                                                        <tr class="text-center">
                                                          <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                            <ng-container *ngFor="let q of [1,2,3,4]">
                                                              <th class="text-center" [attr.colspan]="3">ไตรมาส {{ q }}</th>
                                                            </ng-container>
                                                          </ng-container>
                                                        </tr>
                                                      
                                                        <!-- แถว 3: หัวคอลัมน์ย่อย -->
                                                        <tr class="text-center">
                                                          <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                            <ng-container *ngFor="let q of [1,2,3,4]">
                                                              <th style="width: 1%;">เดือน</th>
                                                              <th style="width: 1%;">แผนงาน</th>
                                                              <th style="width: 3%;">แผนเงิน</th>
                                                            </ng-container>     
                                                          </ng-container>
                                                        </tr>
                                                      </thead>
                                                      <tbody *ngFor="let item_part4_main1 of List_Budget_Request_Income_Multi_Item; let i1_multi_item = index">
                                                        <!-- แถวที่ 1 ของเดือน: [10,1,4,7] -->
                                                        <tr class="text-center">
                                                          <td>
                                                            <span style="color:red">{{ i1_multi_item + 1 }}</span>
                                                          </td>
                                                      
                                                          <td>
                                                            <input type="text" class="form-control"
                                                                   placeholder="กรุณาระบุชื่อกิจกรรม"
                                                                   [(ngModel)]="item_part4_main1.List_Name">
                                                          </td>
                                                      
                                                        <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                            <ng-container *ngIf="ensureYear(y)">
                                                                <ng-container *ngFor="let m of rowMonths[0]">
                                                                    <ng-container
                                                                        *ngFor="let item_part4_main1_month_plan of getList_Multi_Month_Plan_Item_detail('Main',item_part4_main1.Request_Income_Multi_Id, y,item_part4_main1.List_Name,i1_multi_item); let i_month_plan_main = index">
                                                                        <td>{{ monthLabel[m] }}</td>
                                                                        <td>
                                                                            <input type="checkbox" class="form-check-input"
                                                                                [(ngModel)]="item_part4_main1_month_plan['Is_Month' + m]" [disabled]="true">
                                                                        </td>
                                                                        <td>
                                                                            <input type="number" step="0.01" class="form-control" [placeholder]="monthLabel[m]"
                                                                                [(ngModel)]="item_part4_main1_month_plan['Month' + m + '_Amount']" [disabled]="true">
                                                                            <span style="font-size:10px; cursor:pointer; color:orangered" data-bs-toggle="modal"
                                                                                data-bs-target="#exampleModalFullscreenLg"
                                                                                (click)="open_week_plan(Modal_Week_Plan,'Main',m,item_part4_main1.Request_Income_Multi_Id,item_part4_main1.Is_Used_BG,y,i1_multi_item,item_part4_main1.List_Name,'',0)">
                                                                                [วางแผนรายสัปดาห์]
                                                                            </span>
                                                                        </td>
                                                                    </ng-container>
                                                                </ng-container>
                                                            </ng-container>
                                                        </ng-container>
                                                      
                                                          <td>
                                                            <button type="button" class="btn btn-ghost-danger waves-effect waves-light"
                                                                    style="padding:2px 6px;"
                                                                    (click)="btn_del_Income_Multi_Item(i1_multi_item, 'Main')">
                                                              <i class="ri-delete-bin-6-fill" style="color:orangered;font-size:16px;"></i>
                                                            </button>
                                                          </td>
                                                        </tr>
                                                      
                                                        <!-- แถวที่ 2 ของเดือน: [11,2,5,8] -->
                                                        <tr class="text-center">
                                                          <td></td><td></td>
                                                      
                                                          <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                            <ng-container *ngIf="ensureYear(y)">
                                                                <ng-container *ngFor="let m of rowMonths[1]">
                                                                    <ng-container
                                                                        *ngFor="let item_part4_main1_month_plan of getList_Multi_Month_Plan_Item_detail('Main',item_part4_main1.Request_Income_Multi_Id, y,item_part4_main1.List_Name,i1_multi_item); let i_month_plan_main = index">
                                                                        <td>{{ monthLabel[m] }}</td>
                                                                        <td>
                                                                            <input type="checkbox" class="form-check-input"
                                                                                [(ngModel)]="item_part4_main1_month_plan['Is_Month' + m]" [disabled]="true">
                                                                        </td>
                                                                        <td>
                                                                            <input type="number" step="0.01" class="form-control" [placeholder]="monthLabel[m]"
                                                                                [(ngModel)]="item_part4_main1_month_plan['Month' + m + '_Amount']" [disabled]="true">
                                                                            <span style="font-size:10px; cursor:pointer; color:orangered" data-bs-toggle="modal"
                                                                                data-bs-target="#exampleModalFullscreenLg"
                                                                                (click)="open_week_plan(Modal_Week_Plan,'Main',m,item_part4_main1.Request_Income_Multi_Id,item_part4_main1.Is_Used_BG,y,i1_multi_item,item_part4_main1.List_Name,'',0)">
                                                                                [วางแผนรายสัปดาห์]
                                                                            </span>
                                                                        </td>
                                                                    </ng-container>
                                                                  </ng-container>
                                                            </ng-container>
                                                            
                                                          </ng-container>
                                                      
                                                          <td></td>
                                                        </tr>
                                                      
                                                        <!-- แถวที่ 3 ของเดือน: [12,3,6,9] -->
                                                        <tr class="text-center">
                                                          <td></td><td></td>
                                                      
                                                          <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                            <ng-container *ngIf="ensureYear(y)">
                                                                <ng-container *ngFor="let m of rowMonths[2]">
                                                                    <ng-container
                                                                        *ngFor="let item_part4_main1_month_plan of getList_Multi_Month_Plan_Item_detail('Main',item_part4_main1.Request_Income_Multi_Id, y,item_part4_main1.List_Name,i1_multi_item); let i_month_plan_main = index">
                                                                        <td>{{ monthLabel[m] }}</td>
                                                                        <td>
                                                                            <input type="checkbox" class="form-check-input"
                                                                                [(ngModel)]="item_part4_main1_month_plan['Is_Month' + m]" [disabled]="true">
                                                                        </td>
                                                                        <td>
                                                                            <input type="number" step="0.01" class="form-control" [placeholder]="monthLabel[m]"
                                                                                [(ngModel)]="item_part4_main1_month_plan['Month' + m + '_Amount']" [disabled]="true">
                                                                            <span style="font-size:10px; cursor:pointer; color:orangered" data-bs-toggle="modal"
                                                                                data-bs-target="#exampleModalFullscreenLg"
                                                                                (click)="open_week_plan(Modal_Week_Plan,'Main',m,item_part4_main1.Request_Income_Multi_Id,item_part4_main1.Is_Used_BG,y,i1_multi_item,item_part4_main1.List_Name,'',0)">
                                                                                [วางแผนรายสัปดาห์]
                                                                            </span>
                                                                        </td>
                                                                    </ng-container>
                                                                  </ng-container>
                                                            </ng-container>
                                                            
                                                          </ng-container>
                                                      
                                                          <td></td>
                                                        </tr>
                                                        <!-- วางแผนรายสัปดาห์ Main -->
                                                        <ng-template #Modal_Week_Plan let-modal>
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title"
                                                                        id="exampleModalFullscreenLgLabel">
                                                                        วางแผนรายสัปดาห์ ({{weeklyData[0].Fk_Month_Id ==
                                                                        1 ? 'ม.ค.' : weeklyData[0].Fk_Month_Id == 2 ?
                                                                        'ก.พ.' : weeklyData[0].Fk_Month_Id == 3 ?
                                                                        'มี.ค.' : weeklyData[0].Fk_Month_Id == 4 ?
                                                                        'เม.ย.' : weeklyData[0].Fk_Month_Id == 5 ?
                                                                        'พ.ค.' : weeklyData[0].Fk_Month_Id == 6 ?
                                                                        'มิ.ย.' : weeklyData[0].Fk_Month_Id == 7 ?
                                                                        'ก.ค.' : weeklyData[0].Fk_Month_Id == 8 ? 'ส.ค.'
                                                                        : weeklyData[0].Fk_Month_Id == 9 ? 'ก.ย.' :
                                                                        weeklyData[0].Fk_Month_Id == 10 ? 'ต.ค.' :
                                                                        weeklyData[0].Fk_Month_Id == 11 ? 'พ.ย.' :
                                                                        weeklyData[0].Fk_Month_Id == 12 ? 'ธ.ค.' : ''}})
                                                                    </h5>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <div
                                                                                style="margin-bottom: 8px; display: flex; flex-direction: column; gap: 6px;">
                                                                                <!-- วางแผนรายสัปดาห์ -->
                                                                                <table class="table table-gridjs"
                                                                                    style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                                                    <thead>
                                                                                        <tr>
                                                                                            <th>สัปดาห์ที่</th>
                                                                                            <th>แผนงาน</th>
                                                                                            <th>แผนเงิน</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td>สัปดาห์ที่ 1</td>
                                                                                            <td>
                                                                                                <input type="checkbox"
                                                                                                    class="form-check-input"
                                                                                                    [(ngModel)]="weeklyData[0].Is_Week1"
                                                                                                    (change)="onCheckboxChange_week(item_part4_main1,weeklyData, 'Is_Week1',item_part4_main1.Request_Income_Multi_Id,'Main',i1_multi_item)">
                                                                                            </td>
                                                                                            <td>
                                                                                                <input type="number"
                                                                                                    step="0.01"
                                                                                                    [(ngModel)]="weeklyData[0].Week1_Amount"
                                                                                                    (ngModelChange)="add_amount_week('Main',item_part4_main1.Request_Income_Multi_Id, weeklyData, i1_multi_item,0)"
                                                                                                    class="form-control" [disabled]="item_part4_main1.Is_Used_BG == 1">
                                                                                            </td>


                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td>สัปดาห์ที่ 2</td>
                                                                                            <td>
                                                                                                <input type="checkbox"
                                                                                                    class="form-check-input"
                                                                                                    [(ngModel)]="weeklyData[0].Is_Week2"
                                                                                                    (change)="onCheckboxChange_week(item_part4_main1,weeklyData, 'Is_Week2',item_part4_main1.Request_Income_Multi_Id ,'Main',i1_multi_item)">
                                                                                            </td>
                                                                                            <td>
                                                                                                <input type="number"
                                                                                                    step="0.01"
                                                                                                    [(ngModel)]="weeklyData[0].Week2_Amount"
                                                                                                    (ngModelChange)="add_amount_week('Main',item_part4_main1.Request_Income_Multi_Id, weeklyData, i1_multi_item,0)"
                                                                                                    class="form-control" [disabled]="item_part4_main1.Is_Used_BG == 1">
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td>สัปดาห์ที่ 3</td>
                                                                                            <td>
                                                                                                <input type="checkbox"
                                                                                                    class="form-check-input"
                                                                                                    [(ngModel)]="weeklyData[0].Is_Week3"
                                                                                                    (change)="onCheckboxChange_week(item_part4_main1,weeklyData, 'Is_Week3',item_part4_main1.Request_Income_Multi_Id,'Main',i1_multi_item)">
                                                                                            </td>
                                                                                            <td>
                                                                                                <input type="number"
                                                                                                    step="0.01"
                                                                                                    [(ngModel)]="weeklyData[0].Week3_Amount"
                                                                                                    (ngModelChange)="add_amount_week('Main',item_part4_main1.Request_Income_Multi_Id, weeklyData, i1_multi_item,0)"
                                                                                                    class="form-control" [disabled]="item_part4_main1.Is_Used_BG == 1">
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td>สัปดาห์ที่ 4</td>
                                                                                            <td>
                                                                                                <input type="checkbox"
                                                                                                    class="form-check-input"
                                                                                                    [(ngModel)]="weeklyData[0].Is_Week4"
                                                                                                    (change)="onCheckboxChange_week(item_part4_main1,weeklyData, 'Is_Week4',item_part4_main1.Request_Income_Multi_Id,'Main',i1_multi_item)">
                                                                                            </td>
                                                                                            <td>
                                                                                                <input type="number"
                                                                                                    step="0.01"
                                                                                                    [(ngModel)]="weeklyData[0].Week4_Amount"
                                                                                                    (ngModelChange)="add_amount_week('Main',item_part4_main1.Request_Income_Multi_Id, weeklyData, i1_multi_item,0)"
                                                                                                    class="form-control" [disabled]="item_part4_main1.Is_Used_BG == 1">
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <!-- <button type="button"
                                                                                    class="btn btn-soft-primary waves-effect waves-light"
                                                                                    (click)="add_plan_week(Modal_Week_Plan1, 'save', 1, item_part4_main1.Request_Income_Multi_Id)">บันทึก</button> -->
                                                                    <button type="button"
                                                                        class="btn btn-soft-primary waves-effect waves-light"
                                                                        (click)="save_week_plan('Main',weeklyData[0].Fk_Month_Id,item_part4_main1.Request_Income_Multi_Id,weeklyData[0].Bgyear_Plan,item_part4_main1.List_Name,'',i1_multi_item,0)">บันทึก</button>
                                                                </div>
                                                            </div>
                                                        </ng-template>
                                                        <!-- บล็อคส่วน "ไม่ใช้งบประมาณ" และ modal ของคุณ วางต่อได้ตามเดิม -->
                                                        <tr>
                                                            <td></td>
                                                            <td>
                                                                <input type="checkbox" class="form-check-input"
                                                                    [(ngModel)]="item_part4_main1.Is_Used_BG"
                                                                    (change)="onChange_Not_Used_BG(item_part4_main1,i1_multi_item)">
                                                                ไม่ใช้งบประมาณ
                                                            </td>  
                                                            <td colspan="12" [attr.colspan]="12 * Budget_Request_Income.Project_Year_Count">
                                                                <div class="row">
                                                                    <div class="col-lg-2">
                                                                        <span
                                                                            style="font-size:10px;color:orangered">โปรดระบุชื่อผู้รับผิดชอบกิจกรรม</span>
                                                                        <br>
                                                                        <input type="text" class="form-control"
                                                                            placeholder="ชื่อผู้รับผิดชอบกิจกรรม"
                                                                            [(ngModel)]="item_part4_main1.Respon_Name">
                                                                    </div>
                                                                    <div class="col-lg-2" style="width:200px">
                                                                        <span
                                                                            style="font-size:10px;color:orangered">[ถ้ามีกิจกรรมย่อย]</span>
                                                                        <br>
                                                                        <button type="button"
                                                                            class="btn btn-soft-primary waves-effect waves-light"
                                                                            (click)="add_form_Income_Multi_Item_detail_sub(i1_multi_item,item_part4_main1.List_Name)">เพิ่มรายการกิจกรรม
                                                                            (ย่อย)</button>
                                                                    </div>
                                                                    <div class="col-lg-1">
                                                                        <span
                                                                            style="font-size:10px;color:orangered">กำหนดตัวคูณ/รายละเอียด</span>
                                                                        <br>
                                                                        <button type="button"
                                                                            class="btn btn-soft-primary waves-effect waves-light"
                                                                            data-bs-toggle="modal"
                                                                            data-bs-target="#exampleModalFullscreenLg"
                                                                            (click)="Open_multi_detail(Modal_Multi_Detail,'add',item_part4_main1.Request_Income_Multi_Id,item_part4_main1.List_Name)"
                                                                            [disabled]="item_part4_main1.Is_Used_BG == 1">เพิ่มรายการตัวคูณ</button>
                                                                            <!-- Modal เพิ่มรายการตัวคูณ -->
                                                                        <ng-template #Modal_Multi_Detail let-modal>                                                                            
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <h5 class="modal-title"
                                                                                        id="exampleModalFullscreenLgLabel">
                                                                                        รายการตัวคูณ</h5>
                                                                                    <button type="button"
                                                                                        class="btn-close"
                                                                                        data-bs-dismiss="modal"
                                                                                        aria-label="Close"
                                                                                        (click)="modal.dismiss('Cross click')"></button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <div class="row">
                                                                                        <div
                                                                                            class="col-lg-12 text-left">
                                                                                            <button type="button"
                                                                                                class="btn btn-soft-primary waves-effect waves-light"
                                                                                                (click)="add_form_Multi_Plan_Item_detail('Main',item_part4_main1.Request_Income_Multi_Id,i1_multi_item,0,item_part4_main1.List_Name,'ชื่อกิจกกรมย่อย')">เพิ่มรายการย่อยตัวคูณ</button>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div style="height:15px"></div>
                                                                                    <div class="row">
                                                                                        <div class="col-lg-12">
                                                                                            <div class="table-responsive"
                                                                                                style="overflow-x:auto;">
                                                                                                <table
                                                                                                    class="table table-gridjs"
                                                                                                    style="width: max-content; min-width: 200%; font-size: 12px; margin: 0 auto;">
                                                                                                    <thead>
                                                                                                        <tr>
                                                                                                            <th
                                                                                                                style="width: 2%;">
                                                                                                                ลำดับ
                                                                                                            </th>
                                                                                                            <th
                                                                                                                style="width: 1%;">
                                                                                                                ลบ</th>
                                                                                                            <th
                                                                                                                style="width: 15%;">
                                                                                                                ค่าใช้จ่าย
                                                                                                            </th>
                                                                                                            <th
                                                                                                                style="width: 5%;">
                                                                                                                รวมทั้งสิ้น
                                                                                                            </th>
                                                                                                            <th
                                                                                                                style="width: 35%;">
                                                                                                                รายละเอียดค่าใช้จ่าย
                                                                                                            </th>
                                                                                                        </tr>
                                                                                                    </thead>
                                                                                                    <tbody
                                                                                                        *ngFor="let item_part4_main3 of getList_Multi_Plan_Item_detail('Main',item_part4_main1.Request_Income_Multi_Id,i1_multi_item,0); let i = index">
                                                                                                        <tr>
                                                                                                            <td
                                                                                                                class="text-right">
                                                                                                                {{i +
                                                                                                                1}}
                                                                                                            </td>
                                                                                                            <th
                                                                                                                style="width: 1%; padding: 6px 8px;">
                                                                                                                <button
                                                                                                                    type="button"
                                                                                                                    class="btn btn-ghost-danger waves-effect waves-light"
                                                                                                                    style="padding: 2px 6px;"
                                                                                                                    (click)="btn_del_Multi_Plan_Item(i)">
                                                                                                                    <i class="ri-delete-bin-6-fill"
                                                                                                                        style="color: orangered;font-size: 16px;"></i>
                                                                                                                </button>
                                                                                                            </th>
                                                                                                            <td>
                                                                                                                <input
                                                                                                                    type="text"
                                                                                                                    class="form-control"
                                                                                                                    placeholder="ค่าใช้จ่าย"
                                                                                                                    [(ngModel)]="item_part4_main3.Plan_Name" />
                                                                                                            </td>
                                                                                                            <td>
                                                                                                                <span
                                                                                                                    style="color:red">{{item_part4_main3.Plan_Amount_Total
                                                                                                                    |
                                                                                                                    number:'1.2-2'}}</span>
                                                                                                            </td>
                                                                                                            <td>


                                                                                                                <div
                                                                                                                    class="cell-wrapper">
                                                                                                                    <div
                                                                                                                        class="cell-row d-flex flex-wrap gap-2">
                                                                                                                        <ng-container
                                                                                                                            *ngFor="let n of [1, 2, 3, 4, 5, 6]">
                                                                                                                            <div
                                                                                                                                class="d-flex align-items-center gap-1 mb-1">
                                                                                                                                <span
                                                                                                                                    class="text-danger">{{
                                                                                                                                    n
                                                                                                                                    }}</span>
                                                                                                                                <input
                                                                                                                                    type="number"
                                                                                                                                    class="form-control form-control-sm flex-shrink-0"
                                                                                                                                    step="0.01"
                                                                                                                                    style="min-width: 90px; max-width: 100px;"
                                                                                                                                    placeholder="ระบุจำนวน"
                                                                                                                                    [(ngModel)]="item_part4_main3['Plan' + n + '_Amount']"
                                                                                                                                    (ngModelChange)="cal_total_multi_plan(item_part4_main3)" />

                                                                                                                                <input
                                                                                                                                    type="text"
                                                                                                                                    class="form-control form-control-sm flex-shrink-0"
                                                                                                                                    placeholder="ระบุหน่วยนับ"
                                                                                                                                    style="min-width: 80px; max-width: 90px;"
                                                                                                                                    [(ngModel)]="item_part4_main3['Plan' + n + '_Unit_Name']" />
                                                                                                                            </div>
                                                                                                                        </ng-container>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                            </td>
                                                                                                        </tr>
                                                                                                        <tr>
                                                                                                            <td>

                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div style="height:15px"></div>
                                                                                    <div class="row">
                                                                                        <div
                                                                                            class="col-lg-12 text-left">
                                                                                            <button type="button"
                                                                                                class="btn btn-soft-primary waves-effect waves-light"
                                                                                                (click)="save_multi_detail('Main',item_part4_main1.Request_Income_Multi_Id,i1_multi_item,0,item_part4_main1.List_Name)">บันทึก</button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                </div>
                                                                            </div>
                                                                        </ng-template>
                                                                        <!-- ✅ Modal Template -->
                                                                    </div>
                                                                    <div class="col-lg-1">
                                                                        <span style="font-size:10px">รวมตัวคูณ</span>
                                                                        <br>
                                                                        <span
                                                                            style="font-size:30px;color:orangered">{{item_part4_main1.Plan_Amount_Total
                                                                            | number:'1.2-2'}}</span>
                                                                    </div>
                                                                    <div class="col-lg-2">
                                                                        <span style="font-size:10px">รวมแผนงาน</span>
                                                                        <br>
                                                                        <span
                                                                            style="font-size:30px;color:orangered">{{item_part4_main1.Month_Amount_Total
                                                                            | number:'1.2-2'}}</span>
                                                                    </div>
                                                                </div>
                                                            </td>
                                                            <td></td>                  
                                                        </tr>
                                                        <!-- รายการกิจกรรม (ย่อย) -->
                                                        <ng-container
                                                            *ngFor="let item_part4_main1_sub of getMulti_Item_Sub_By_ParentIndex(i1_multi_item,item_part4_main1.Request_Income_Multi_Id); let i1_multi_item_sub = index">
                                                            <!-- แถวที่ 1 ของเดือน: [10,1,4,7] -->
                                                            <tr class="text-center" style="background-color:rgb(207, 229, 243);">
                                                                <td></td>
                                                                  <td>
                                                                    <div class="row">
                                                                        <div class="col-lg-1">
                                                                            <span style="color:red">{{i1_multi_item + 1}}.{{i1_multi_item_sub
                                                                                + 1}}</span>
                                                                        </div>
                                                                        <div class="col-lg-11">
                                                                            <input type="text" class="form-control"
                                                                                placeholder="กรุณาระบุชื่อกิจกรรม"
                                                                                [(ngModel)]="item_part4_main1_sub.List_Name">
                                                                        </div>
                                                                    </div>
                                                                  </td>
                                                                <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                                    <ng-container *ngIf="ensureYear(y)">
                                                                        <ng-container *ngFor="let m of rowMonths[0]">
                                                                            <ng-container
                                                                                *ngFor="let item_part4_main1_month_plan_Sub of getList_Multi_Month_Plan_Item_detail_Sub(item_part4_main1_sub.Request_Income_Multi_Id, y,i1_multi_item,i1_multi_item_sub,item_part4_main1.List_Name); let i1_sub = index">
                                                                                <td>{{ monthLabel[m] }}</td>
                                                                                <td>
                                                                                    <input type="checkbox" class="form-check-input"
                                                                                        [(ngModel)]="item_part4_main1_month_plan_Sub['Is_Month' + m]" [disabled]="true">
                                                                                </td>
                                                                                <td>
                                                                                    <input type="number" step="0.01" class="form-control" [placeholder]="monthLabel[m]"
                                                                                        [(ngModel)]="item_part4_main1_month_plan_Sub['Month' + m + '_Amount']" [disabled]="true">
                                                                                    <span style="font-size:10px; cursor:pointer; color:orangered" data-bs-toggle="modal"
                                                                                        data-bs-target="#exampleModalFullscreenLg"
                                                                                        (click)="open_week_plan(Modal_Week_Plan1,'Sub',m,item_part4_main1_sub.Request_Income_Multi_Id,item_part4_main1_sub.Is_Used_BG,y,i1_multi_item,item_part4_main1.List_Name,item_part4_main1_sub.List_Name,i1_multi_item_sub)">
                                                                                        [วางแผนรายสัปดาห์]
                                                                                    </span>
                                                                                </td>
                                                                            </ng-container>
                                                                        </ng-container>
                                                                    </ng-container>
                                                                </ng-container>
                                                              
                                                                  <td>
                                                                    <button type="button" class="btn btn-ghost-danger waves-effect waves-light"
                                                                            style="padding:2px 6px;"
                                                                            (click)="DeleteSubItemByParentAndSubIndex(i1_multi_item, i1_multi_item_sub,item_part4_main1.Request_Income_Multi_Id)">
                                                                      <i class="ri-delete-bin-6-fill" style="color:orangered;font-size:16px;"></i>
                                                                    </button>
                                                                  </td>
                                                            </tr>
                                                            <!-- แถวที่ 2 ของเดือน: [11,2,5,8] -->
                                                        <tr class="text-center" style="background-color:rgb(207, 229, 243);">
                                                            <td></td><td></td>
                                                        
                                                            <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                              <ng-container *ngIf="ensureYear(y)">
                                                                  <ng-container *ngFor="let m of rowMonths[1]">
                                                                      <ng-container
                                                                      *ngFor="let item_part4_main1_month_plan_Sub of getList_Multi_Month_Plan_Item_detail_Sub(item_part4_main1_sub.Request_Income_Multi_Id, y,i1_multi_item,i1_multi_item_sub,item_part4_main1.List_Name); let i1_sub = index">
                                                                          <td>{{ monthLabel[m] }}</td>
                                                                          <td>
                                                                              <input type="checkbox" class="form-check-input"
                                                                                  [(ngModel)]="item_part4_main1_month_plan_Sub['Is_Month' + m]" [disabled]="true">
                                                                          </td>
                                                                          <td>
                                                                              <input type="number" step="0.01" class="form-control" [placeholder]="monthLabel[m]"
                                                                                  [(ngModel)]="item_part4_main1_month_plan_Sub['Month' + m + '_Amount']" [disabled]="true">
                                                                              <span style="font-size:10px; cursor:pointer; color:orangered" data-bs-toggle="modal"
                                                                                  data-bs-target="#exampleModalFullscreenLg"
                                                                                  (click)="open_week_plan(Modal_Week_Plan1,'Sub',m,item_part4_main1_sub.Request_Income_Multi_Id,item_part4_main1_sub.Is_Used_BG,y,i1_multi_item,item_part4_main1.List_Name,item_part4_main1_sub.List_Name,i1_multi_item_sub)">
                                                                                  [วางแผนรายสัปดาห์]
                                                                              </span>
                                                                          </td>
                                                                      </ng-container>
                                                                    </ng-container>
                                                              </ng-container>
                                                              
                                                            </ng-container>
                                                        
                                                            <td></td>
                                                          </tr>
                                                          <!-- แถวที่ 3 ของเดือน: [12,3,6,9] -->
                                                        <tr class="text-center" style="background-color:rgb(207, 229, 243);">
                                                            <td></td><td></td>
                                                            <ng-container *ngFor="let y of getProjectYears(Budget_Request_Income.Project_Year_Count)">
                                                              <ng-container *ngIf="ensureYear(y)">
                                                                  <ng-container *ngFor="let m of rowMonths[2]">
                                                                      <ng-container
                                                                      *ngFor="let item_part4_main1_month_plan_Sub of getList_Multi_Month_Plan_Item_detail_Sub(item_part4_main1_sub.Request_Income_Multi_Id, y,i1_multi_item,i1_multi_item_sub,item_part4_main1.List_Name); let i1_sub = index">
                                                                          <td>{{ monthLabel[m] }}</td>
                                                                          <td>
                                                                              <input type="checkbox" class="form-check-input"
                                                                                  [(ngModel)]="item_part4_main1_month_plan_Sub['Is_Month' + m]" [disabled]="true">
                                                                          </td>
                                                                          <td>
                                                                              <input type="number" step="0.01" class="form-control" [placeholder]="monthLabel[m]"
                                                                                  [(ngModel)]="item_part4_main1_month_plan_Sub['Month' + m + '_Amount']" [disabled]="true">
                                                                              <span style="font-size:10px; cursor:pointer; color:orangered" data-bs-toggle="modal"
                                                                                  data-bs-target="#exampleModalFullscreenLg"
                                                                                  (click)="open_week_plan(Modal_Week_Plan1,'Sub',m,item_part4_main1_sub.Request_Income_Multi_Id,item_part4_main1_sub.Is_Used_BG,y,i1_multi_item,item_part4_main1.List_Name,item_part4_main1_sub.List_Name,i1_multi_item_sub)">
                                                                                  [วางแผนรายสัปดาห์]
                                                                              </span>
                                                                          </td>
                                                                      </ng-container>
                                                                    </ng-container>
                                                              </ng-container>
                                                              
                                                            </ng-container>
                                                        
                                                            <td></td>
                                                          </tr>
                                                         <!-- วางแผนรายสัปดาห์ Sub -->
                                                        <ng-template #Modal_Week_Plan1 let-modal>
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title"
                                                                        id="exampleModalFullscreenLgLabel">
                                                                        วางแผนรายสัปดาห์ ({{weeklyData_Sub[0].Fk_Month_Id ==
                                                                        1 ? 'ม.ค.' : weeklyData_Sub[0].Fk_Month_Id == 2 ?
                                                                        'ก.พ.' : weeklyData_Sub[0].Fk_Month_Id == 3 ?
                                                                        'มี.ค.' : weeklyData_Sub[0].Fk_Month_Id == 4 ?
                                                                        'เม.ย.' : weeklyData_Sub[0].Fk_Month_Id == 5 ?
                                                                        'พ.ค.' : weeklyData_Sub[0].Fk_Month_Id == 6 ?
                                                                        'มิ.ย.' : weeklyData_Sub[0].Fk_Month_Id == 7 ?
                                                                        'ก.ค.' : weeklyData_Sub[0].Fk_Month_Id == 8 ? 'ส.ค.'
                                                                        : weeklyData_Sub[0].Fk_Month_Id == 9 ? 'ก.ย.' :
                                                                        weeklyData_Sub[0].Fk_Month_Id == 10 ? 'ต.ค.' :
                                                                        weeklyData_Sub[0].Fk_Month_Id == 11 ? 'พ.ย.' :
                                                                        weeklyData_Sub[0].Fk_Month_Id == 12 ? 'ธ.ค.' : ''}})
                                                                    </h5>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="row">
                                                                        <div class="col-lg-12">
                                                                            <div
                                                                                style="margin-bottom: 8px; display: flex; flex-direction: column; gap: 6px;">
                                                                                <!-- วางแผนรายสัปดาห์ -->
                                                                                <table class="table table-gridjs"
                                                                                    style="width: 100%; font-size: 12px; margin: 0 auto;">
                                                                                    <thead>
                                                                                        <tr>
                                                                                            <th>สัปดาห์ที่</th>
                                                                                            <th>แผนงาน</th>
                                                                                            <th>แผนเงิน</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <tbody>
                                                                                        <tr>
                                                                                            <td>สัปดาห์ที่ 1</td>
                                                                                            <td>
                                                                                                <input type="checkbox"
                                                                                                    class="form-check-input"
                                                                                                    [(ngModel)]="weeklyData_Sub[0].Is_Week1"
                                                                                                    (change)="onCheckboxChange_week(item_part4_main1,weeklyData_Sub, 'Is_Week1',item_part4_main1.Request_Income_Multi_Id,'Sub',i1_multi_item_sub)">
                                                                                            </td>
                                                                                            <td>
                                                                                                <input type="number"
                                                                                                    step="0.01"
                                                                                                    [(ngModel)]="weeklyData_Sub[0].Week1_Amount"
                                                                                                    (ngModelChange)="add_amount_week('Sub',item_part4_main1_sub.Request_Income_Multi_Id, weeklyData_Sub, i1_multi_item,i1_multi_item_sub)"
                                                                                                    class="form-control" [disabled]="item_part4_main1_sub.Is_Used_BG == 1">
                                                                                            </td>


                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td>สัปดาห์ที่ 2</td>
                                                                                            <td>
                                                                                                <input type="checkbox"
                                                                                                    class="form-check-input"
                                                                                                    [(ngModel)]="weeklyData_Sub[0].Is_Week2"
                                                                                                    (change)="onCheckboxChange_week(item_part4_main1,weeklyData_Sub, 'Is_Week2',item_part4_main1.Request_Income_Multi_Id,'Sub',i1_multi_item_sub)">
                                                                                            </td>
                                                                                            <td>
                                                                                                <input type="number"
                                                                                                    step="0.01"
                                                                                                    [(ngModel)]="weeklyData_Sub[0].Week2_Amount"
                                                                                                    (ngModelChange)="add_amount_week('Sub',item_part4_main1_sub.Request_Income_Multi_Id, weeklyData_Sub, i1_multi_item,i1_multi_item_sub)"
                                                                                                    class="form-control" [disabled]="item_part4_main1_sub.Is_Used_BG == 1">
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td>สัปดาห์ที่ 3</td>
                                                                                            <td>
                                                                                                <input type="checkbox"
                                                                                                    class="form-check-input"
                                                                                                    [(ngModel)]="weeklyData_Sub[0].Is_Week3"
                                                                                                    (change)="onCheckboxChange_week(item_part4_main1,weeklyData_Sub, 'Is_Week3',item_part4_main1.Request_Income_Multi_Id,'Sub',i1_multi_item_sub)">
                                                                                            </td>
                                                                                            <td>
                                                                                                <input type="number"
                                                                                                    step="0.01"
                                                                                                    [(ngModel)]="weeklyData_Sub[0].Week3_Amount"
                                                                                                    (ngModelChange)="add_amount_week('Sub',item_part4_main1_sub.Request_Income_Multi_Id, weeklyData_Sub, i1_multi_item,i1_multi_item_sub)"
                                                                                                    class="form-control" [disabled]="item_part4_main1_sub.Is_Used_BG == 1">
                                                                                            </td>
                                                                                        </tr>
                                                                                        <tr>
                                                                                            <td>สัปดาห์ที่ 4</td>
                                                                                            <td>
                                                                                                <input type="checkbox"
                                                                                                    class="form-check-input"
                                                                                                    [(ngModel)]="weeklyData_Sub[0].Is_Week4"
                                                                                                    (change)="onCheckboxChange_week(item_part4_main1,weeklyData_Sub, 'Is_Week4',item_part4_main1.Request_Income_Multi_Id,'Sub',i1_multi_item_sub)">
                                                                                            </td>
                                                                                            <td>
                                                                                                <input type="number"
                                                                                                    step="0.01"
                                                                                                    [(ngModel)]="weeklyData_Sub[0].Week4_Amount"
                                                                                                    (ngModelChange)="add_amount_week('Sub',item_part4_main1_sub.Request_Income_Multi_Id, weeklyData_Sub, i1_multi_item,i1_multi_item_sub)"
                                                                                                    class="form-control" [disabled]="item_part4_main1_sub.Is_Used_BG == 1">
                                                                                            </td>
                                                                                        </tr>
                                                                                    </tbody>
                                                                                </table>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button"
                                                                        class="btn btn-soft-primary waves-effect waves-light"
                                                                        (click)="save_week_plan('Sub',weeklyData_Sub[0].Fk_Month_Id,item_part4_main1_sub.Fk_Multi_Parent_Id,weeklyData_Sub[0].Bgyear_Plan,item_part4_main1.List_Name,item_part4_main1_sub.List_Name,i1_multi_item,i1_multi_item_sub)">บันทึก</button>
                                                                </div>
                                                            </div>
                                                        </ng-template>
                                                            <!-- บล็อคส่วน "ไม่ใช้งบประมาณ" และ modal ของคุณ วางต่อได้ตามเดิม -->
                                                            <tr style="background-color:rgb(207, 229, 243);">
                                                            <td></td>
                                                            <td>
                                                                <input type="checkbox" class="form-check-input"
                                                                    [(ngModel)]="item_part4_main1_sub.Is_Used_BG"
                                                                    (change)="onChange_Not_Used_BG_Sub(item_part4_main1_sub,i1_multi_item_sub)">
                                                                ไม่ใช้งบประมาณ
                                                            </td>  
                                                            <td style="text-align:left" [attr.colspan]="12 * Budget_Request_Income.Project_Year_Count">
                                                                <div class="row">
                                                                    <div class="col-lg-2"></div>
                                                                    <div class="col-lg-2" style="width:200px"></div>
                                                                    <div class="col-lg-1">
                                                                        <span
                                                                            style="font-size:10px;color:orangered">กำหนดตัวคูณ/รายละเอียด</span>
                                                                        <br>
                                                                        <button type="button"
                                                                            class="btn btn-soft-primary waves-effect waves-light"
                                                                            data-bs-toggle="modal"
                                                                            data-bs-target="#exampleModalFullscreenLg"
                                                                            (click)="Open_multi_detail_Sub(Modal_Multi_Detail_Sub,'add',item_part4_main1_sub.Request_Income_Multi_Id,item_part4_main1_sub.List_Name,item_part4_main1_sub)"
                                                                            [disabled]="item_part4_main1_sub.Is_Used_BG == 1">เพิ่มรายการตัวคูณ</button>
                                                                            <!-- Modal เพิ่มรายการตัวคูณ -->
                                                                        <ng-template #Modal_Multi_Detail_Sub let-modal>                                                                            
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <h5 class="modal-title"
                                                                                        id="exampleModalFullscreenLgLabel">
                                                                                        รายการตัวคูณ</h5>
                                                                                    <button type="button"
                                                                                        class="btn-close"
                                                                                        data-bs-dismiss="modal"
                                                                                        aria-label="Close"
                                                                                        (click)="modal.dismiss('Cross click')"></button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <div class="row">
                                                                                        <div
                                                                                            class="col-lg-12 text-left">
                                                                                            <button type="button"
                                                                                                class="btn btn-soft-primary waves-effect waves-light"
                                                                                                (click)="add_form_Multi_Plan_Item_detail('Sub',item_part4_main1_sub.Request_Income_Multi_Id,i1_multi_item,i1_multi_item_sub,item_part4_main1.List_Name,item_part4_main1_sub.List_Name)">เพิ่มรายการย่อยตัวคูณ</button>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div style="height:15px"></div>
                                                                                    <div class="row">
                                                                                        <div class="col-lg-12">
                                                                                            <div class="table-responsive"
                                                                                                style="overflow-x:auto;">
                                                                                                <table
                                                                                                    class="table table-gridjs"
                                                                                                    style="width: max-content; min-width: 200%; font-size: 12px; margin: 0 auto;">
                                                                                                    <thead>
                                                                                                        <tr>
                                                                                                            <th
                                                                                                                style="width: 2%;">
                                                                                                                ลำดับ
                                                                                                            </th>
                                                                                                            <th
                                                                                                                style="width: 1%;">
                                                                                                                ลบ</th>
                                                                                                            <th
                                                                                                                style="width: 15%;">
                                                                                                                ค่าใช้จ่าย
                                                                                                            </th>
                                                                                                            <th
                                                                                                                style="width: 5%;">
                                                                                                                รวมทั้งสิ้น
                                                                                                            </th>
                                                                                                            <th
                                                                                                                style="width: 35%;">
                                                                                                                รายละเอียดค่าใช้จ่าย
                                                                                                            </th>
                                                                                                        </tr>
                                                                                                    </thead>
                                                                                                    <tbody
                                                                                                        *ngFor="let item_part4_main3 of getList_Multi_Plan_Item_detail('Sub',item_part4_main1_sub.Request_Income_Multi_Id,i1_multi_item,i1_multi_item_sub); let i = index">
                                                                                                        <tr>
                                                                                                            <td
                                                                                                                class="text-right">
                                                                                                                {{i +
                                                                                                                1}}
                                                                                                            </td>
                                                                                                            <th
                                                                                                                style="width: 1%; padding: 6px 8px;">
                                                                                                                <button
                                                                                                                    type="button"
                                                                                                                    class="btn btn-ghost-danger waves-effect waves-light"
                                                                                                                    style="padding: 2px 6px;"
                                                                                                                    (click)="btn_del_Multi_Plan_Item(i)">
                                                                                                                    <i class="ri-delete-bin-6-fill"
                                                                                                                        style="color: orangered;font-size: 16px;"></i>
                                                                                                                </button>
                                                                                                            </th>
                                                                                                            <td>
                                                                                                                <input
                                                                                                                    type="text"
                                                                                                                    class="form-control"
                                                                                                                    placeholder="ค่าใช้จ่าย"
                                                                                                                    [(ngModel)]="item_part4_main3.Plan_Name" />
                                                                                                            </td>
                                                                                                            <td>
                                                                                                                <span
                                                                                                                    style="color:red">{{item_part4_main3.Plan_Amount_Total
                                                                                                                    |
                                                                                                                    number:'1.2-2'}}</span>
                                                                                                            </td>
                                                                                                            <td>


                                                                                                                <div
                                                                                                                    class="cell-wrapper">
                                                                                                                    <div
                                                                                                                        class="cell-row d-flex flex-wrap gap-2">
                                                                                                                        <ng-container
                                                                                                                            *ngFor="let n of [1, 2, 3, 4, 5, 6]">
                                                                                                                            <div
                                                                                                                                class="d-flex align-items-center gap-1 mb-1">
                                                                                                                                <span
                                                                                                                                    class="text-danger">{{
                                                                                                                                    n
                                                                                                                                    }}</span>
                                                                                                                                <input
                                                                                                                                    type="number"
                                                                                                                                    class="form-control form-control-sm flex-shrink-0"
                                                                                                                                    step="0.01"
                                                                                                                                    style="min-width: 90px; max-width: 100px;"
                                                                                                                                    placeholder="ระบุจำนวน"
                                                                                                                                    [(ngModel)]="item_part4_main3['Plan' + n + '_Amount']"
                                                                                                                                    (ngModelChange)="cal_total_multi_plan(item_part4_main3)" />

                                                                                                                                <input
                                                                                                                                    type="text"
                                                                                                                                    class="form-control form-control-sm flex-shrink-0"
                                                                                                                                    placeholder="ระบุหน่วยนับ"
                                                                                                                                    style="min-width: 80px; max-width: 90px;"
                                                                                                                                    [(ngModel)]="item_part4_main3['Plan' + n + '_Unit_Name']" />
                                                                                                                            </div>
                                                                                                                        </ng-container>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                            </td>
                                                                                                        </tr>
                                                                                                        <tr>
                                                                                                            <td>

                                                                                                            </td>
                                                                                                        </tr>
                                                                                                    </tbody>
                                                                                                </table>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div style="height:15px"></div>
                                                                                    <div class="row">
                                                                                        <div
                                                                                            class="col-lg-12 text-left">
                                                                                            <button type="button"
                                                                                                class="btn btn-soft-primary waves-effect waves-light"
                                                                                                (click)="save_multi_detail('Sub',item_part4_main1_sub.Request_Income_Multi_Id,i1_multi_item,i1_multi_item_sub,item_part4_main1_sub.List_Name)">บันทึก</button>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                </div>
                                                                            </div>
                                                                        </ng-template>
                                                                        <!-- ✅ Modal Template -->
                                                                    </div>
                                                                    <div class="col-lg-1">
                                                                        <span style="font-size:10px">รวมตัวคูณ</span>
                                                                        <br>
                                                                        <span
                                                                            style="font-size:30px;color:orangered">{{item_part4_main1_sub.Plan_Amount_Total
                                                                            | number:'1.2-2'}}</span>
                                                                    </div>
                                                                    <div class="col-lg-2">
                                                                        <span style="font-size:10px">รวมแผนงาน</span>
                                                                        <br>
                                                                        <span
                                                                            style="font-size:30px;color:orangered">{{item_part4_main1_sub.Month_Amount_Total
                                                                            | number:'1.2-2'}}</span>
                                                                    </div>
                                                                </div>
                                                            </td> 
                                                            <td></td>                 
                                                        </tr>
                                                                                                                
                                                        
                                                            </ng-container>
                                                      </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </li>
            </ul>
            <div class="tab-content text-muted">
                <div [ngbNavOutlet]="Border"></div>
            </div>

        </div><!--end col-->
    </div>
</section>






<!--วางแผนรายสัปดาห์แบบเก่า-->
<!-- <ng-template #Modal_Week_Plan10 let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="exampleModalFullscreenLgLabel">วางแผนรายสัปดาห์ (ต.ค.)</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                (click)="modal.dismiss('Cross click')"></button>
        </div>
        <div class="modal-body">
            <div class="row">
                <div class="col-lg-12">
                    <div style="margin-bottom: 8px; display: flex; flex-direction: column; gap: 6px;">
                        <table class="table table-gridjs"
                        style="width: 100%; font-size: 12px; margin: 0 auto;">
                        <thead>
                            <tr>
                                <th>สัปดาห์ที่</th>
                                <th>แผนงาน</th>
                                <th>แผนเงิน</th>
                            </tr>
                        </thead>
                        <tbody *ngFor="let item_part4_main2_month10 of getList_Multi_Week_Plan_Item_detail(item_part4_main1.Request_Income_Multi_Id,10); let i2 = index" > 
                            <tr>
                                <td>สัปดาห์ที่ 1</td>
                                <td>
                                    <input type="checkbox"
                                        class="form-check-input" 
                                        [(ngModel)]="item_part4_main2_month10.Is_Week1" (change)="onCheckboxChange_week(item_part4_main1,item_part4_main2_month10, 'Is_Week1',item_part4_main1.Request_Income_Multi_Id, 10)">
                                </td>
                                <td>
                                    <input type="number" step="0.01"
                                        class="form-control" 
                                        [(ngModel)]="item_part4_main2_month10.Week1_Amount" (ngModelChange)="add_amount_week(item_part4_main1.Request_Income_Multi_Id, 10)">
                                </td>


                            </tr>
                            <tr>
                                <td>สัปดาห์ที่ 2</td>
                                <td>
                                    <input type="checkbox"
                                        class="form-check-input" 
                                        [(ngModel)]="item_part4_main2_month10.Is_Week2" (change)="onCheckboxChange_week(item_part4_main1,item_part4_main2_month10, 'Is_Week2',item_part4_main1.Request_Income_Multi_Id, 10)">
                                </td>
                                <td>
                                    <input type="number" step="0.01"
                                        class="form-control" 
                                        [(ngModel)]="item_part4_main2_month10.Week2_Amount" (ngModelChange)="add_amount_week(item_part4_main1.Request_Income_Multi_Id, 10)">
                                </td>
                            </tr>
                            <tr>
                                <td>สัปดาห์ที่ 3</td>
                                <td>
                                    <input type="checkbox"
                                        class="form-check-input" 
                                        [(ngModel)]="item_part4_main2_month10.Is_Week3" (change)="onCheckboxChange_week(item_part4_main1,item_part4_main2_month10, 'Is_Week3',item_part4_main1.Request_Income_Multi_Id, 10)">
                                </td>
                                <td>
                                    <input type="number" step="0.01"
                                        class="form-control" 
                                        [(ngModel)]="item_part4_main2_month10.Week3_Amount" (ngModelChange)="add_amount_week(item_part4_main1.Request_Income_Multi_Id, 10)">
                                </td>
                            </tr>
                            <tr>
                                <td>สัปดาห์ที่ 4</td>
                                <td>
                                    <input type="checkbox"
                                        class="form-check-input" 
                                        [(ngModel)]="item_part4_main2_month10.Is_Week4" (change)="onCheckboxChange_week(item_part4_main1,item_part4_main2_month10, 'Is_Week4',item_part4_main1.Request_Income_Multi_Id, 10)">
                                </td>
                                <td>
                                    <input type="number" step="0.01"
                                        class="form-control" 
                                        [(ngModel)]="item_part4_main2_month10.Week4_Amount" (ngModelChange)="add_amount_week(item_part4_main1.Request_Income_Multi_Id, 10)">
                                </td>
                            </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-1">
                    
                </div>
            </div>
        </div>
        <div class="modal-footer">
                        <button type="button" class="btn btn-soft-primary waves-effect waves-light" (click)="save_week_plan(10,item_part4_main1.Request_Income_Multi_Id)">บันทึก</button>
        </div>
    </div>
</ng-template> -->

<!-- ใส่ครั้งเดียวตรงหน้าเพจ/คอมโพเนนต์ -->
<style>
    /* ความกว้างเท่าตัวอย่าง */
    .col-month { width: 20px; min-width: 20px; }
    .col-work  { width: 60px; min-width: 60px; text-align:center; }
    .col-money { width: 20px; min-width: 20px; }
  
    /* ให้ input กินเต็มคอลัมน์เงิน */
    .col-money .form-control { width: 100%; }
  </style>